<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trang không tìm thấy</title>
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <main class="container empty-state">
    <h1 class="error-code">404</h1>
    <p class="error-message">Rất tiếc, trang bạn đang tìm kiếm không tồn tại.</p>

    <div class="suggested-content">
      <h2 class="suggested-title">Có thể bạn sẽ thích những bộ phim này:</h2>
      <div id="suggest" class="movie-grid"></div>
    </div>

    <a class="btn primary home-button" href="index.html">← Về trang chủ</a>
  </main>

  <script src="assets/js/utils.js"></script>
  <script>
    (async function () {
      const { fetchJSON, html, createElementFromHTML } = window.$u;
      const host = document.getElementById('suggest');

      try {
        const allMovies = await fetchJSON('https://raw.githubusercontent.com/crytals-sc/json-link/refs/heads/main/movies.json');

        // 1. Xáo trộn toàn bộ danh sách phim
        const shuffled = allMovies.sort(() => 0.5 - Math.random());

        // 2. Lấy 6 phim đầu tiên từ danh sách đã xáo trộn
        const randomMovies = shuffled.slice(0, 6);

        randomMovies.forEach(m => {
          // 3. Sử dụng cấu trúc HTML mới cho movie-card để đồng bộ giao diện
          const movieLink = `movie.html?id=${encodeURIComponent(m.id)}`;
          const movieCardHTML = html`
            <article class="movie-card">
              <a href="${movieLink}" title="${m.title}">
                <div class="card-image">
                  <img class="poster" src="${m.poster}" alt="Poster ${m.title}" loading="lazy" />
                </div>
                <div class="card-base-info">
                  <h3 class="movie-title">${m.title}</h3>
                </div>
              </a>
            </article>
          `;
          host.appendChild(createElementFromHTML(movieCardHTML));
        });

      } catch (e) {
        // Luôn ghi lại lỗi để dễ dàng gỡ lỗi
        console.error("Không thể tải hoặc hiển thị phim gợi ý:", e);
        host.innerHTML = '<p style="color: var(--muted);">Không thể tải danh sách phim gợi ý.</p>';
      }
    })();
  </script>
</body>

</html>